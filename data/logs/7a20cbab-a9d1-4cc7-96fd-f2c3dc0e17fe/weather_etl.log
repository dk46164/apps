2024-10-29 00:48:33  - weather_etl - [INFO] - pipeline.execute_pipeline: - Initializing pipeline with config from /Users/deepakkumar/Desktop/weather_analyzer/config/config.yaml
2024-10-29 00:48:33  - weather_etl - [INFO] - pipeline.execute_pipeline: - Created pipeline directories at /Users/deepakkumar/Desktop/weather_analyzer
2024-10-29 00:48:33  - weather_etl - [INFO] - pipeline.execute_pipeline: - Pipeline will execute steps: extract, transform, profile, analyze, load
2024-10-29 00:48:33  - weather_etl - [INFO] - pipeline.execute_pipeline: - Starting execution of step: extract
2024-10-29 00:48:33  - weather_etl - [DEBUG] - pipeline.execute_pipeline: - Executing extract as initial step
2024-10-29 00:48:33  - weather_etl - [INFO] - step_executor.execute_step: - Starting execution of pipeline step: extract
2024-10-29 00:48:33  - weather_etl - [DEBUG] - step_executor.execute_step: - Calling extract function with input data
2024-10-29 00:48:33  - weather_etl - [INFO] - weather_data_reader.execute_extract: - Starting execute_extract function
2024-10-29 00:48:33  - weather_etl - [DEBUG] - weather_data_reader.execute_extract: - Retrieving input path from config dictionary
2024-10-29 00:48:33  - weather_etl - [INFO] - weather_data_reader.execute_extract: - Input path configured as: /Users/deepakkumar/Desktop/weather_analyzer/data/input/ETL_developer_Case.json
2024-10-29 00:48:33  - weather_etl - [DEBUG] - weather_data_reader.execute_extract: - Initiating JSON file reading process
2024-10-29 00:48:33  - weather_etl - [INFO] - weather_data_reader.execute_extract: - Successfully extracted data for 5 cities
2024-10-29 00:48:33  - weather_etl - [DEBUG] - weather_data_reader.execute_extract: - Extracted data keys: Bangkok, Thailand, Chiang Mai, Thailand, Phuket, Thailand, Pattaya, Thailand, Hat Yai, Thailand
2024-10-29 00:48:33  - weather_etl - [INFO] - weather_data_reader.execute_extract: - Completed execute_extract function
2024-10-29 00:48:33  - weather_etl - [DEBUG] - step_executor.execute_step: - Saving state for step: extract
2024-10-29 00:48:33  - weather_etl - [DEBUG] - step_executor.execute_step: - Creating checkpoint for step: extract
2024-10-29 00:48:33  - weather_etl - [INFO] - step_executor.execute_step: - Successfully completed step: extract
2024-10-29 00:48:33  - weather_etl - [INFO] - pipeline.execute_pipeline: - Saved metadata for step extract
2024-10-29 00:48:33  - weather_etl - [INFO] - pipeline.execute_pipeline: - Starting execution of step: transform
2024-10-29 00:48:33  - weather_etl - [DEBUG] - pipeline.execute_pipeline: - Executing transform with input from extract
2024-10-29 00:48:33  - weather_etl - [INFO] - step_executor.execute_step: - Starting execution of pipeline step: transform
2024-10-29 00:48:33  - weather_etl - [DEBUG] - step_executor.execute_step: - Calling transform function with input data
2024-10-29 00:48:33  - weather_etl - [INFO] - weather_data_processing.execute_transform: - Starting transform execution
2024-10-29 00:48:33  - weather_etl - [DEBUG] - weather_data_processing.execute_transform: - Retrieved raw data for transformation
2024-10-29 00:48:34  - weather_etl - [DEBUG] - weather_data_processing.execute_transform: - Successfully parsed weather dataframes
2024-10-29 00:48:34  - weather_etl - [INFO] - weather_data_processing.execute_transform: - Successfully completed transform execution
2024-10-29 00:48:34  - weather_etl - [DEBUG] - step_executor.execute_step: - Saving state for step: transform
2024-10-29 00:48:34  - weather_etl - [DEBUG] - step_executor.execute_step: - Creating checkpoint for step: transform
2024-10-29 00:48:34  - weather_etl - [INFO] - step_executor.execute_step: - Successfully completed step: transform
2024-10-29 00:48:34  - weather_etl - [INFO] - pipeline.execute_pipeline: - Saved metadata for step transform
2024-10-29 00:48:34  - weather_etl - [DEBUG] - pipeline.execute_pipeline: - Cleaned up data from extract
2024-10-29 00:48:34  - weather_etl - [INFO] - pipeline.execute_pipeline: - Starting execution of step: profile
2024-10-29 00:48:34  - weather_etl - [DEBUG] - pipeline.execute_pipeline: - Executing profile with input from transform
2024-10-29 00:48:34  - weather_etl - [INFO] - step_executor.execute_step: - Starting execution of pipeline step: profile
2024-10-29 00:48:34  - weather_etl - [DEBUG] - step_executor.execute_step: - Calling profile function with input data
2024-10-29 00:48:34  - weather_etl - [INFO] - weather_data_profiling.execute_profile: - Starting weather data profiling execution
2024-10-29 00:48:34  - weather_etl - [INFO] - weather_data_profiling.execute_profile: - Processing 5 current records, 15 forecast records, 5 location records
2024-10-29 00:48:34  - weather_etl - [ERROR] - step_executor.execute_step: - Failed to execute step profile: No active exception to reraise
Traceback (most recent call last):
  File "/Users/deepakkumar/Desktop/weather_analyzer/src/core/step_executor.py", line 73, in execute_step
    result = step_functions[step](data, config_dict, logger)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/deepakkumar/Desktop/weather_analyzer/src/steps/profiling/weather_data_profiling.py", line 118, in execute_profile
    current_df, forecast_df, location_df = _profile_weather_data(
                                           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/deepakkumar/Desktop/weather_analyzer/src/steps/profiling/weather_data_profiling.py", line 89, in _profile_weather_data
    processed_df = _fill_missing_values(df)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/deepakkumar/Desktop/weather_analyzer/src/steps/profiling/weather_data_profiling.py", line 66, in _fill_missing_values
    raise
RuntimeError: No active exception to reraise
2024-10-29 00:48:34  - weather_etl - [ERROR] - pipeline.execute_pipeline: - Pipeline failed during step profile
2024-10-29 00:48:34  - weather_etl - [ERROR] - pipeline.execute_pipeline: - Error details: No active exception to reraise
2024-10-29 00:48:34  - weather_etl - [ERROR] - pipeline.execute_pipeline: - Stack trace: (<class 'RuntimeError'>, RuntimeError('No active exception to reraise'), <traceback object at 0x137c8e840>)
2024-10-29 00:50:40  - weather_etl - [INFO] - pipeline.execute_pipeline: - Initializing pipeline with config from /Users/deepakkumar/Desktop/weather_analyzer/config/config.yaml
2024-10-29 00:50:40  - weather_etl - [INFO] - pipeline.execute_pipeline: - Created pipeline directories at /Users/deepakkumar/Desktop/weather_analyzer
2024-10-29 00:50:40  - weather_etl - [INFO] - pipeline.execute_pipeline: - Pipeline will execute steps: profile, analyze, load
2024-10-29 00:50:40  - weather_etl - [INFO] - pipeline.execute_pipeline: - Loading dependency data for transform
2024-10-29 00:50:40  - weather_etl - [INFO] - state.load_step_data: - Loading data for step: transform
2024-10-29 00:50:40  - weather_etl - [DEBUG] - state.load_step_data: - Loading CSV files from /Users/deepakkumar/Desktop/weather_analyzer/data/state/transform
2024-10-29 00:50:40  - weather_etl - [DEBUG] - state.load_step_data: - Loading raw_current.csv
2024-10-29 00:50:40  - weather_etl - [DEBUG] - state.load_step_data: - Loading raw_location.csv
2024-10-29 00:50:40  - weather_etl - [DEBUG] - state.load_step_data: - Loading raw_forecast.csv
2024-10-29 00:50:40  - weather_etl - [INFO] - pipeline.execute_pipeline: - Starting execution of step: profile
2024-10-29 00:50:40  - weather_etl - [DEBUG] - pipeline.execute_pipeline: - Executing profile with input from transform
2024-10-29 00:50:40  - weather_etl - [INFO] - step_executor.execute_step: - Starting execution of pipeline step: profile
2024-10-29 00:50:40  - weather_etl - [DEBUG] - step_executor.execute_step: - Calling profile function with input data
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_data_profiling.execute_profile: - Starting weather data profiling execution
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_data_profiling.execute_profile: - Processing 5 current records, 15 forecast records, 5 location records
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_data_profiling.execute_profile: - Weather data profiling completed successfully
2024-10-29 00:50:40  - weather_etl - [DEBUG] - step_executor.execute_step: - Saving state for step: profile
2024-10-29 00:50:40  - weather_etl - [DEBUG] - step_executor.execute_step: - Creating checkpoint for step: profile
2024-10-29 00:50:40  - weather_etl - [INFO] - step_executor.execute_step: - Successfully completed step: profile
2024-10-29 00:50:40  - weather_etl - [INFO] - pipeline.execute_pipeline: - Saved metadata for step profile
2024-10-29 00:50:40  - weather_etl - [DEBUG] - pipeline.execute_pipeline: - Cleaned up data from transform
2024-10-29 00:50:40  - weather_etl - [INFO] - pipeline.execute_pipeline: - Starting execution of step: analyze
2024-10-29 00:50:40  - weather_etl - [DEBUG] - pipeline.execute_pipeline: - Executing analyze with input from profile
2024-10-29 00:50:40  - weather_etl - [INFO] - step_executor.execute_step: - Starting execution of pipeline step: analyze
2024-10-29 00:50:40  - weather_etl - [DEBUG] - step_executor.execute_step: - Calling analyze function with input data
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_temperature_analysis.execute_analyze: - Starting temperature analysis execution
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_temperature_analysis.execute_analyze: - Processing data for 5 locations
2024-10-29 00:50:40  - weather_etl - [DEBUG] - weather_temperature_analysis.execute_analyze: - Merging current and forecast weather data
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_temperature_analysis.execute_analyze: - Successfully merged DataFrames, resulting in 15 records
2024-10-29 00:50:40  - weather_etl - [DEBUG] - weather_temperature_analysis.execute_analyze: - Calculating days with maximum temperatures
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_temperature_analysis.execute_analyze: - Identified maximum temperature days for 5 cities
2024-10-29 00:50:40  - weather_etl - [DEBUG] - weather_temperature_analysis.execute_analyze: - Computing temperature aggregations per city
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_temperature_analysis.execute_analyze: - Generated temperature aggregations for 5 cities
2024-10-29 00:50:40  - weather_etl - [DEBUG] - weather_temperature_analysis.execute_analyze: - Computing forecasted vs current temperature differences
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_temperature_analysis.execute_analyze: - Successfully calculated temperature differences
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_temperature_analysis.execute_analyze: - Analysis summary:
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_temperature_analysis.execute_analyze: - - location_df: 5 records
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_temperature_analysis.execute_analyze: - - current_df: 5 records
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_temperature_analysis.execute_analyze: - - forecast_df: 15 records
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_temperature_analysis.execute_analyze: - - max_temp_df: 5 records
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_temperature_analysis.execute_analyze: - - forcasted_agg_df: 5 records
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_temperature_analysis.execute_analyze: - - curr_forc_temp_diff_df: 15 records
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_temperature_analysis.execute_analyze: - Temperature analysis completed successfully
2024-10-29 00:50:40  - weather_etl - [DEBUG] - step_executor.execute_step: - Saving state for step: analyze
2024-10-29 00:50:40  - weather_etl - [DEBUG] - step_executor.execute_step: - Creating checkpoint for step: analyze
2024-10-29 00:50:40  - weather_etl - [INFO] - step_executor.execute_step: - Successfully completed step: analyze
2024-10-29 00:50:40  - weather_etl - [INFO] - pipeline.execute_pipeline: - Saved metadata for step analyze
2024-10-29 00:50:40  - weather_etl - [DEBUG] - pipeline.execute_pipeline: - Cleaned up data from profile
2024-10-29 00:50:40  - weather_etl - [INFO] - pipeline.execute_pipeline: - Starting execution of step: load
2024-10-29 00:50:40  - weather_etl - [DEBUG] - pipeline.execute_pipeline: - Executing load with input from analyze
2024-10-29 00:50:40  - weather_etl - [INFO] - step_executor.execute_step: - Starting execution of pipeline step: load
2024-10-29 00:50:40  - weather_etl - [DEBUG] - step_executor.execute_step: - Calling load function with input data
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_csv_writer.execute_load: - Starting data export process
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_csv_writer.execute_load: - Output directory set to: /Users/deepakkumar/Desktop/weather_analyzer/data/output/7a20cbab-a9d1-4cc7-96fd-f2c3dc0e17fe
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_csv_writer.execute_load: - Output directory created/verified
2024-10-29 00:50:40  - weather_etl - [INFO] - weather_csv_writer.execute_load: - Successfully exported all weather data to CSV files
2024-10-29 00:50:40  - weather_etl - [DEBUG] - step_executor.execute_step: - Saving state for step: load
2024-10-29 00:50:40  - weather_etl - [DEBUG] - step_executor.execute_step: - Creating checkpoint for step: load
2024-10-29 00:50:40  - weather_etl - [INFO] - step_executor.execute_step: - Successfully completed step: load
2024-10-29 00:50:40  - weather_etl - [INFO] - pipeline.execute_pipeline: - Saved metadata for step load
2024-10-29 00:50:40  - weather_etl - [DEBUG] - pipeline.execute_pipeline: - Cleaned up data from analyze
2024-10-29 00:50:40  - weather_etl - [DEBUG] - state.clean_directory: - Removed file: /Users/deepakkumar/Desktop/weather_analyzer/data/checkpoints/analyze.done
2024-10-29 00:50:40  - weather_etl - [DEBUG] - state.clean_directory: - Removed file: /Users/deepakkumar/Desktop/weather_analyzer/data/checkpoints/extract.done
2024-10-29 00:50:40  - weather_etl - [DEBUG] - state.clean_directory: - Removed file: /Users/deepakkumar/Desktop/weather_analyzer/data/checkpoints/transform.done
2024-10-29 00:50:40  - weather_etl - [DEBUG] - state.clean_directory: - Removed file: /Users/deepakkumar/Desktop/weather_analyzer/data/checkpoints/load.done
2024-10-29 00:50:40  - weather_etl - [DEBUG] - state.clean_directory: - Removed file: /Users/deepakkumar/Desktop/weather_analyzer/data/checkpoints/profile.done
2024-10-29 00:50:40  - weather_etl - [DEBUG] - state.clean_directory: - Removed file: /Users/deepakkumar/Desktop/weather_analyzer/data/state/7a20cbab-a9d1-4cc7-96fd-f2c3dc0e17fe.run_id
2024-10-29 00:50:40  - weather_etl - [DEBUG] - state.clean_directory: - Removed directory: /Users/deepakkumar/Desktop/weather_analyzer/data/state/load
2024-10-29 00:50:40  - weather_etl - [DEBUG] - state.clean_directory: - Removed directory: /Users/deepakkumar/Desktop/weather_analyzer/data/state/profile
2024-10-29 00:50:40  - weather_etl - [DEBUG] - state.clean_directory: - Removed directory: /Users/deepakkumar/Desktop/weather_analyzer/data/state/analyze
2024-10-29 00:50:40  - weather_etl - [DEBUG] - state.clean_directory: - Removed directory: /Users/deepakkumar/Desktop/weather_analyzer/data/state/extract
2024-10-29 00:50:40  - weather_etl - [DEBUG] - state.clean_directory: - Removed directory: /Users/deepakkumar/Desktop/weather_analyzer/data/state/transform
2024-10-29 00:50:40  - weather_etl - [INFO] - state.clean_directory: - Cleaned contents while preserving directories: [PosixPath('/Users/deepakkumar/Desktop/weather_analyzer/data/checkpoints'), PosixPath('/Users/deepakkumar/Desktop/weather_analyzer/data/state')]
2024-10-29 00:50:40  - weather_etl - [INFO] - pipeline.execute_pipeline: - Pipeline completed successfully
